var JSParser=Editor.Parser=(function(){var b={atom:true,number:true,variable:true,string:true,regexp:true};function d(j,f,e,i,g,h){this.indented=j;this.column=f;this.type=e;if(i!=null){this.align=i}this.prev=g;this.info=h}function c(e){return function(g){var i=g&&g.charAt(0),h=e.type;var f=i==h;if(h=="vardef"){return e.indented+4}else{if(h=="form"&&i=="{"){return e.indented}else{if(h=="stat"||h=="form"){return e.indented+indentUnit}else{if(e.info=="switch"&&!f){return e.indented+(/^(?:case|default)\b/.test(g)?indentUnit:2*indentUnit)}else{if(e.align){return e.column-(f?1:0)}else{return e.indented+(f?0:indentUnit)}}}}}}}function a(g,I){var D=tokenizeJavaScript(g);var F=[n];var S=null;var x=new d((I||0)-indentUnit,0,"block",false);var N=0;var p=0;var y,l;var C={next:j,copy:R};function j(){while(F[F.length-1].lex){F.pop()()}var T=D.next();if(T.type=="whitespace"&&N==0){p=T.value.length}N+=T.value.length;if(T.content=="\n"){p=N=0;if(!("align" in x)){x.align=false}T.indentation=c(x)}if(T.type=="whitespace"||T.type=="comment"){return T}if(!("align" in x)){x.align=true}while(true){y=l=false;F.pop()(T.type,T.content);if(y){if(l){T.style=l}else{if(T.type=="variable"&&z(T.content)){T.style="js-localvariable"}}return T}}}function R(){var V=S,U=x,W=F.concat([]),T=D.state;return function X(Y){S=V;x=U;F=W.concat([]);N=p=0;D=tokenizeJavaScript(Y,T);return C}}function P(T){for(var U=T.length-1;U>=0;U--){F.push(T[U])}}function H(){P(arguments);y=true}function e(){P(arguments);y=false}function q(T){l=T}function w(){S={prev:S,vars:{"this":true,"arguments":true}}}function v(){S=S.prev}function r(T){if(S){q("js-variabledef");S.vars[T]=true}}function z(T){var U=S;while(U){if(U.vars[T]){return true}U=U.prev}return false}function o(U,V){var T=function(){x=new d(p,N,U,null,x,V)};T.lex=true;return T}function G(){x=x.prev}G.lex=true;function f(U){return function T(V){if(V==U){H()}else{H(arguments.callee)}}}function n(T){return e(B,n)}function B(T){if(T=="var"){H(o("vardef"),K,f(";"),G)}else{if(T=="keyword a"){H(o("form"),A,B,G)}else{if(T=="keyword b"){H(o("form"),B,G)}else{if(T=="{"){H(o("}"),s,G)}else{if(T=="function"){H(m)}else{if(T=="for"){H(o("form"),f("("),o(")"),k,f(")"),G,B,G)}else{if(T=="variable"){H(o("stat"),E)}else{if(T=="switch"){H(o("form"),A,o("}","switch"),f("{"),s,G,G)}else{if(T=="case"){H(A,f(":"))}else{if(T=="default"){H(f(":"))}else{if(T=="catch"){H(o("form"),w,f("("),u,f(")"),B,G,v)}else{e(o("stat"),A,f(";"),G)}}}}}}}}}}}}function A(T){if(b.hasOwnProperty(T)){H(M)}else{if(T=="function"){H(m)}else{if(T=="keyword c"){H(A)}else{if(T=="("){H(o(")"),A,f(")"),G,M)}else{if(T=="operator"){H(A)}else{if(T=="["){H(o("]"),O(A,"]"),G,M)}else{if(T=="{"){H(o("}"),O(t,"}"),G,M)}}}}}}}}function M(T){if(T=="operator"){H(A)}else{if(T=="("){H(o(")"),A,O(A,")"),G,M)}else{if(T=="."){H(Q,M)}else{if(T=="["){H(o("]"),A,f("]"),G,M)}}}}}function E(T){if(T==":"){H(G,B)}else{e(M,f(";"),G)}}function Q(T){if(T=="variable"){q("js-property");H()}}function t(T){if(T=="variable"){q("js-property")}if(b.hasOwnProperty(T)){H(f(":"),A)}}function O(V,T){function U(X){if(X==","){H(V,U)}else{if(X==T){H()}else{H(f(T))}}}return function W(X){if(X==T){H()}else{e(V,U)}}}function s(T){if(T=="}"){H()}else{e(B,s)}}function K(T,U){if(T=="variable"){r(U);H(J)}else{H()}}function J(T,U){if(U=="="){H(A,J)}else{if(T==","){H(K)}}}function k(T){if(T=="var"){H(K,i)}else{if(T==";"){e(i)}else{if(T=="variable"){H(L)}else{e(i)}}}}function L(T,U){if(U=="in"){H(A)}else{H(M,i)}}function i(T,U){if(T==";"){H(h)}else{if(U=="in"){H(A)}else{H(A,f(";"),h)}}}function h(T){if(T==")"){e()}else{H(A)}}function m(T,U){if(T=="variable"){r(U);H(m)}else{if(T=="("){H(w,O(u,")"),B,v)}}}function u(T,U){if(T=="variable"){r(U);H()}}return C}return{make:a,electricChars:"{}:"}})();