Ext.namespace("AuIt.Editor.htmlProperty.Element","AuIt.Editor.htmlProperty.Panel","AuIt.Editor.htmlProperty.Grid","AuIt.Editor.htmlProperty.GridEditor");AuIt.Editor.htmlProperty.Options={combo_font:[["",""],["Arial, Helvetica, sans-serif","Arial, Helvetica, sans-serif"],["Courier New, Courier, mono","Courier New, Courier, mono"],["Georgia, Times New Roman, Times, serif","Georgia, Times New Roman, Times, serif"],["Geneva, Arial, Helvetica, sans-serif","Geneva, Arial, Helvetica, sans-serif"],["Times New Roman, Times, serif","Times New Roman, Times, serif"],["Verdana, Arial, Helvetica, sans-serif","Verdana, Arial, Helvetica, sans-serif"]],combo_measurement:[["px","pixels"],["pt","points"],["em","em"],["in","in"],["cm","cm"],["mm","mm"],["picas","picas"],["ems","ems"],["exs","exs"],["%","%"]],combo_weight:[["",""],["normal","normal"],["bold","bold"],["bolder","bolder"],["lighter","lighter"],["100","100"],["200","200"],["300","300"],["400","400"],["500","500"],["600","600"],["700","700"],["800","800"],["900","900"]],combo_fstyle:[["",""],["normal","normal"],["italic","italic"],["oblique","oblique"]],combo_variant:[["",""],["normal","normal"],["small-caps","small-caps"]],combo_transform:[["",""],["capitalize","capitalize"],["uppercase","uppercase"],["lowercase","lowercase"]],combo_attachment:[["",""],["fixed","fixed"],["scroll","scroll"]],combo_repeat:[["",""],["repeat","repeat"],["repeat-x","repeat-x"],["repeat-y","repeat-y"],["no-repeat","no-repeat"]],combo_listtype:[["",""],["disc","disc"],["circle","circle"],["square","square"],["decimal","decimal"],["lower-roman","lower-roman"],["upper-roman","upper-roman"],["lower-alpha","lower-alpha"],["upper-alpha","upper-alpha"],["none","none"]],combo_listposition:[["",""],["inside","inside"],["outside","outside"]],combo_clear:[["",""],["left","left"],["right","right"],["both","both"],["none","none"]],combo_cursor:[["",""],["crosshair","crosshair"],["default","default"],["help","help"],["move","move"],["pointer","pointer"],["progress","progress"],["text","text"],["wait","wait"]],combo_display:[["",""],["block","block"],["inline","inline"],["inline-block","inline-block"],["list-item","list-item"]],combo_float:[["",""],["left","left"],["right","right"],["none","none"]],combo_overflow:[["",""],["visible","visible"],["hidden","hidden"],["scroll","scroll"],["auto","auto"]],combo_position:[["",""],["absolute","absolute"],["fixed","fixed"],["relative","relative"],["static","static"]],combo_visibility:[["",""],["visible","visible"],["hidden","hidden"],["collapse","collapse"],["inherit","inherit"]],combo_direction:[["",""],["ltr","ltr"],["rtl","rtl"]],combo_aligncss:[["",""],["left","left"],["right","right"],["center","center"],["justify","justify"]],combo_decoration:[["",""],["underline","underline"],["overline","overline"],["line-through","line-through"],["blink","blink"]],combo_whitespace:[["",""],["normal","normal"],["nowrap","nowrap"],["pre","pre"],["pre-line","pre-line"],["pre-wrap","pre-wrap"]],combo_borderstyle:[["",""],["none","none"],["hidden","hidden"],["dotted","dotted"],["dashed","dashed"],["solid","solid"],["double","double"],["groove","groove"],["ridge","ridge"],["inset","inset"],["outset","outset"]],combo_outlinestyle:[["",""],["none","none"],["dotted","dotted"],["dashed","dashed"],["solid","solid"],["double","double"],["groove","groove"],["ridge","ridge"],["inset","inset"],["outset","outset"]],combo_alignimg:[["",""],["left","Left"],["top","Top"],["middle","Middle"],["bottom","Bottom"],["right","Right"]],combo_aligntable:[["",""],["left","Left"],["center","Center"],["justify","Justify"],["char","Char"],["right","Right"]],combo_aligntr:[["",""],["left","Left"],["center","Center"],["right","Right"]],combo_valigntr:[["",""],["top","top"],["middle","middle"],["bottom","bottom"],["baseline","baseline"]],combo_target:[["",""],["_self","Open in this window"],["_blank","Open in new window"],["_parent","Open in parent window"],["_top","Open in top frame"]]};Ext.namespace("AuIt.Editor.Property");AuIt.Editor.htmlProperty.GridEditor.textarea=Ext.extend(Ext.form.TriggerField,{editable:false,inEditor:false,selectOnFocus:true,triggerClass:"auit-form-image-trigger",getValue:function(a){return this.value},onTriggerClick:function(b){this.triggerBlur();var a=new AuIt.Editor.dlg.TextEditor({id:"AuIt.Editor.dlg.TextEditor_1",textValue:this.value,field:this,onApply:function(c){this.field.setValue(c);this.field.value=c;this.setPropInfo(c)}});a.show()}});AuIt.Editor.htmlProperty.GridEditor.src=Ext.extend(Ext.form.TriggerField,{editable:false,inEditor:false,selectOnFocus:true,triggerClass:"auit-form-image-trigger",decode:function(a){if((p=a.indexOf("##"))>=0){pe=a.indexOf("##",p+1);a=a.substring(p+2,pe);a=decodeURIComponent(a)}return a},setValue:function(a){if(a===undefined){return}this.fullUrl=a;a=this.decode(a);if(this.rendered&&!this.el.dom){this.rendered=false}AuIt.Editor.htmlProperty.GridEditor.src.superclass.setValue.call(this,a)},getValue:function(){return this.fullUrl},onTriggerClick:function(a){this.triggerBlur();var b=this.value;if(this.directive_mask){b=this.directive_mask.replace("{0}",this.value)}AuIt.Editor.fileBrowser.show(this,{directive:b,useRelative:this.useRelative,rootID:this.rootID,field:this,onApply:function(d){var c=d[0].url;c+="##"+encodeURIComponent(d[0].directive)+"##";if(this.field.useRelative){this.field.setValue(d[0].relative2)}else{this.field.setValue(c)}this.setPropInfo(c)}})}});Ext.reg("auit-field-image",AuIt.Editor.htmlProperty.GridEditor.src);AuIt.Editor.htmlProperty.GridEditor.catalogImage=Ext.extend(Ext.form.TriggerField,{editable:false,inEditor:false,selectOnFocus:true,triggerClass:"auit-form-image-trigger",onTriggerClick:function(a){this.triggerBlur();AuIt.Editor.fileBrowser.show(this,{directive:AUIT_EDITOR.file_browser_root.categorie_directive.replace("{0}",this.value),useRelative:true,rootID:AUIT_EDITOR.file_browser_root.categorie,field:this,onApply:function(b){this.field.setValue(b[0].relative2);this.setPropInfo(b[0].relative2)}})}});Ext.reg("auit-catalog-image",AuIt.Editor.htmlProperty.GridEditor.catalogImage);AuIt.Editor.htmlProperty.GridEditor.href=Ext.extend(Ext.form.TriggerField,{editable:false,inEditor:false,selectOnFocus:true,triggerClass:"auit-form-image-trigger",decode:function(a){if((p=a.indexOf("##"))>=0){pe=a.indexOf("##",p+1);a=a.substring(p+2,pe);a=decodeURIComponent(a)}return a},setValue:function(a){if(a===undefined){return}this.fullUrl=a;a=this.decode(a);AuIt.Editor.htmlProperty.GridEditor.href.superclass.setValue.call(this,a)},getValue:function(){return this.fullUrl},onTriggerClick:function(a){this.triggerBlur();AuIt.Editor.Dialog.link(this,{directive:this.value,field:this,onApply:function(c){var b=c[0].url;b+="##"+encodeURIComponent(c[0].directive)+"##";this.field.setValue(b);this.setPropInfo(b)}})}});AuIt.Editor.htmlProperty.GridEditor.blockeditor=Ext.extend(Ext.form.TriggerField,{editable:false,inEditor:false,selectOnFocus:true,triggerClass:"auit-form-image-trigger",getValue:function(a){return this.value},onTriggerClick:function(c){this.triggerBlur();var d=this.value.indexOf("{{widget");if(d>=0&&this.value.indexOf("{{widget",d+1)==-1){var b=this;AuIt.Editor.Dialog.Widget(this,{initTemplate:this.value,onOKInsert:function(e){b.applyTemplate(e.template)}})}else{var a=new AuIt.Editor.dlg.BlockEditor({id:"AuIt.Editor.dlg.BlockEditorr_1",field:this,propertyBasis:this.propInfo.store.grid.propertyHandler,onApply:function(e){},scope:this});a.show()}},applyTemplate:function(b){var d={itemId:"TRANSLATE_BLOCK_TO_HTML"};var c={};var a=AuIt.App.getActiveEditor();if(a){c=a.pageData}AuIt.App.getActionMgr().request(d,{directCall:true,url:AUIT_EDITOR.web_cmd_url,waitMsg:AuIt.locale.BLOCKEDITOR_WAIT,waitWnd:this.el,blockeditor:this,params:{action:"translate_block_to_html",page_id:c.page_id,factory:c.factory,storeId:c.storeId,data:b},LoadSuccess:function(f,g){if(f.data){try{var h=AuIt.App.getActiveEditor();var i=g.blockeditor.propInfo.store.grid.propertyHandler;var j=AuIt.App.getActionMgr().getAction("INTERN_REPLACEHTMLBLOCK","Editor");j.data={DomID:i.DomID,pagedata:i.pagedata,xhtml:f.data.xhtml};j.executeCmd()}catch(k){}}}})}});AuIt.Editor.htmlProperty.GridEditor.color=Ext.extend(Ext.ux.form.ColorPickerField,{editable:true,inEditor:false,selectOnFocus:true,triggerClass:"auit-form-image-trigger",value:"",setValue:function(a){if(a.indexOf("#")==0){a=a.substr(1)}AuIt.Editor.htmlProperty.GridEditor.color.superclass.setValue.call(this,a)},validate:function(){var b=AuIt.Editor.htmlProperty.GridEditor.color.superclass.validate.call(this);if(b&&this.propInfo.editor.editing){var a=this.getRawValue();a=a.replace("#","");if(/^[0-9a-fA-F]{6}$/.test(a)){this.value=a}else{this.value=""}var a=this.getValue();this.propInfo.grid.setValueAt(this.propInfo.rowIndex,a)}return b},triggerBlur:function(){if(!this.inEditor){AuIt.Editor.htmlProperty.GridEditor.color.superclass.triggerBlur.call(this)}},onTriggerClick:function(a){AuIt.Editor.htmlProperty.GridEditor.color.superclass.onTriggerClick.call(this,a)}});AuIt.Editor.htmlProperty.GridEditor.text=Ext.extend(Ext.form.TextField,{selectOnFocus:true,validate:function(){var b=AuIt.Editor.htmlProperty.GridEditor.text.superclass.validate.call(this);if(b&&this.propInfo.editor.editing){var a=this.getValue();this.propInfo.grid.setValueAt(this.propInfo.rowIndex,a)}return b}});AuIt.Editor.htmlProperty.GridEditor.number=Ext.extend(Ext.ux.form.SpinnerField,{selectOnFocus:true,listeners:{spin:function(a){a.field.validate()}},validate:function(){var b=AuIt.Editor.htmlProperty.GridEditor.number.superclass.validate.call(this);if(b&&this.propInfo.editor.editing){var a=this.getValue();this.propInfo.grid.setValueAt(this.propInfo.rowIndex,a)}return b}});AuIt.Editor.htmlProperty.GridEditor.gnumber=Ext.extend(AuIt.Editor.htmlProperty.GridEditor.number,{minValue:0});AuIt.Editor.htmlProperty.GridEditor.Combo=Ext.extend(Ext.form.ComboBox,{allowBlank:true,valueField:"value",displayField:"text",typeAhead:true,mode:"local",triggerAction:"all",selectOnFocus:true,initComponent:function(){this.store=new Ext.data.ArrayStore({id:0,autoDestroy:true,fields:["value","text"],data:this.optionRange});AuIt.Editor.htmlProperty.GridEditor.Combo.superclass.initComponent.call(this)},listeners:{select:function(b){if(b.propInfo.editor.editing){var a=b.getValue();this.propInfo.grid.setValueAt(this.propInfo.rowIndex,a)}}}});AuIt.Editor.htmlProperty.GridEditor.measurement=Ext.extend(Ext.form.Field,{bodyStyle:null,border:false,defaultAutoCreate:{tag:"div"},height:20,onRender:function(b,a){AuIt.Editor.htmlProperty.GridEditor.measurement.superclass.onRender.call(this,b,a);this.valueField=new Ext.ux.form.SpinnerField({flex:1,selectOnFocus:true,minValue:0,maxValue:50000,listeners:{spin:function(d){var c=d.field.getRawValue();if(c>0){if(!this.unitField.getValue()){this.unitField.setValue("px")}}this.validate()},scope:this}});this.unitField=new Ext.form.ComboBox({width:40,allowBlank:true,valueField:"value",displayField:"text",store:new Ext.data.ArrayStore({id:0,autoDestroy:true,fields:["value","text"],data:AuIt.Editor.htmlProperty.Options.combo_measurement}),typeAhead:true,mode:"local",triggerAction:"all",selectOnFocus:true,listeners:{select:function(c,e,d){this.validate()},scope:this}});this.labelField=new Ext.form.Label({width:10,text:" "});this.body=new Ext.Panel({height:this.height,bodyStyle:null,border:false,frame:false,layout:{type:"hbox",pack:"start",align:"stretch"},defaults:{frame:false,border:false},items:[this.valueField,this.unitField],renderTo:this.el})},show:function(){AuIt.Editor.htmlProperty.GridEditor.measurement.superclass.show.call(this);if(this.body){this.body.doLayout(true)}return this.valueField},setSize:function(b,a){if(b<90){b=90}AuIt.Editor.htmlProperty.GridEditor.measurement.superclass.setSize.call(this,b,a);if(this.body&&b!==undefined){this.body.setSize(b,a)}},getRawValue:function(){var a=this.value;if(a===this.emptyText){a=""}return a},getValue:function(){if(!this.rendered){return this.value}var a=this.valueField.getValue();if(a){a+=this.unitField.getValue()}if(a===this.emptyText||a===undefined){a=""}return a},setValue:function(a){this.value=""+a;if(this.rendered){this.valueField.setValue(this.getNumber(this.value));this.unitField.setValue(this.getMeasurement(this.value));this.validate()}return this},validate:function(){var b=AuIt.Editor.htmlProperty.GridEditor.measurement.superclass.validate.call(this);if(b&&this.propInfo.editor.editing){var a=this.getValue();this.propInfo.grid.setValueAt(this.propInfo.rowIndex,a)}return b},getNumber:function(a){if(new RegExp("^[0-9]+[a-z%]+$","gi").test(a)){return a.replace(/[^0-9]/g,"")}return a},getMeasurement:function(a){return a.replace(/^([0-9]+)(.*)$/,"$2")}});AuIt.Editor.htmlProperty.Panel.GridColumnModel=Ext.extend(Ext.grid.ColumnModel,{createEditor:function(b){if(this.editors[b.name]){return this.editors[b.name]}var a;switch(b.xtype){case"blockeditor":case"textarea":return this.getEditor({editor:b.xtype});break;case"hidden":return null}a=this.editors[b.name]=new Ext.grid.GridEditor(Ext.ComponentMgr.create(b));return a},getEditor:function(b){if(!this.editors){this.editors={}}var a=null;if(!b.editor){return a}if(this.editors[b.editor]){return this.editors[b.editor]}if(b.editor.indexOf("combo_")!==-1){a=new Ext.grid.GridEditor(new AuIt.Editor.htmlProperty.GridEditor.Combo({optionRange:AuIt.Editor.htmlProperty.Options[b.editor]}))}else{if(AuIt.Editor.htmlProperty.GridEditor[b.editor]){a=new Ext.grid.GridEditor(new AuIt.Editor.htmlProperty.GridEditor[b.editor]({}))}}this.editors[b.editor]=a;return a},getCellEditor:function(a,b){return this.store.grid.getCellEditor(a,b)},isCellEditable:function(a,b){return this.store.grid.isCellEditable(a,b)},destroy:function(){AuIt.Editor.htmlProperty.Panel.GridColumnModel.superclass.destroy.call(this);if(this.editors){for(var a in this.editors){Ext.destroy(this.editors[a])}}}});AuIt.Editor.EditorGrid=Ext.extend(Ext.grid.EditorGridPanel,{useFilter:true,filterModus:"all",enableColumnMove:false,stripeRows:false,trackMouseOver:false,clicksToEdit:1,enableHdMenu:false,valueIndex:1,groupTextTpl:"{[values.text.substr(2)]}",viewConfig:{forceFit:true},autoExpandColumn:"value",border:false,frame:false,getColModel:function(){return[{id:"name",header:AuIt.locale.EDITORGRID_C1,width:100,sortable:true,editable:false,dataIndex:"name",renderer:this.renderName,scope:this},{id:"value",header:AuIt.locale.EDITORGRID_C2,width:20,sortable:true,editable:true,renderer:this.renderValue,dataIndex:"value",scope:this},{header:"",sortable:false,dataIndex:"CSS_GROUP",editable:false,menuDisabled:true,hidden:true}]},isCellEditable:function(a,b){return a==this.valueIndex},getCellEditor:function(b,e){var a=this.store.getAt(e);var d={editor:a.get("editor")};var c=this.colModel.getEditor(d);return this.addEditorInfo(c,b,e)},addEditorInfo:function(b,a,c){if(b){b.field.propInfo={store:this.store,colIndex:a,rowIndex:c,grid:this,editor:b,Handler:this.propertyHandler,Container:this.propertyHandler.propertyContainer}}return b},renderName:function(d,e,a,f,c,b){if(a.data.tooltip){return'<div ext:qtip="'+Ext.util.Format.htmlEncode(a.data.tooltip)+'">'+d+"</div>"}return d},renderValue:function(c,e,a,f,d,b){if(a.data.einheit.indexOf("dec")>=0){return this.getCellEditor(d,f).field.decode(c)}return Ext.util.Format.htmlEncode(c)},getDataSource:function(){return[]},getToolbar:function(){return null},initComponent:function(){if(this.altKey){AuIt.App.addFktKey({alt:true,key:this.altKey,el:this})}this.tbar=this.getToolbar();var a=new Ext.data.ArrayReader({},[{name:"CSS_GROUP"},{name:"name"},{name:"value"},{name:"einheit"},{name:"editor"},{name:"attribute"},{name:"tooltip"}]);this.store=new Ext.data.GroupingStore({reader:a,sortInfo:{field:"name",direction:"ASC"},data:this.getDataSource(),groupField:"CSS_GROUP",grid:this});if(this.useFilter){this.tools=[];this.store.on("load",this.onLoad,this);this.tools.push({id:"filter",qtip:AuIt.locale.EDITORGRID_TV,scope:this,handler:this.toggleFilter})}this.colModel=new AuIt.Editor.htmlProperty.Panel.GridColumnModel({columns:this.getColModel(),store:this.store});this.view=new Ext.grid.GroupingView({groupTextTpl:this.groupTextTpl});AuIt.Editor.EditorGrid.superclass.initComponent.call(this);this.mon(this.selModel,"beforecellselect",function(d,c,b){if(b===0){this.startEditing.defer(200,this,[c,this.valueIndex]);return false}},this);this.store.on("update",function(c,d,b){this.OnChangeEditEl(c,d,b)},this)},onRender:function(){AuIt.Editor.EditorGrid.superclass.onRender.apply(this,arguments);this.getGridEl().addClass("x-props-grid")},OnChangeEditEl:function(b,c,a){},setValueAt:function(d,b){if(this.propertyHandler&&this.propertyHandler.propertyContainer){this.propertyHandler.propertyContainer.allowedChange(false);try{var a=this.store.getAt(d).get("value");if(a!==b){this.store.getAt(d).set("value",b)}}catch(c){}this.propertyHandler.propertyContainer.allowedChange(true)}else{if(this.store){this.store.getAt(d).set("value",b)}}},onLoad:function(a,b){if(this.useFilter&&this.filterModus=="empty"){a.filterBy(function(c){return c.data.value!=""})}},render:function(a,b){if(this.setStore){this.setStore()}AuIt.Editor.EditorGrid.superclass.render.call(this,a,b)},setHTMLElement:function(a){if(!a){return}this.editEl=a;if(this.isVisible()&&!this.collapsed){this.setStore()}return},expand:function(a){if(this.setStore){this.setStore()}AuIt.Editor.EditorGrid.superclass.expand.call(this,a)},setStoreFilter:function(){if(this.useFilter&&this.filterModus=="empty"){this.store.filterBy(function(a){return a.data.value!=""})}else{if(this.store.isFiltered()){this.store.clearFilter()}else{if(this.rendered){this.getView().refresh()}}}},toggleFilter:function(c,b,a){this.stopEditing();this.filterModus=this.filterModus=="empty"?"all":"empty";if(this.useFilter&&this.filterModus=="empty"){b.addClass("x-tool-filter-empty")}else{b.removeClass("x-tool-filter-empty")}this.setStoreFilter()}});