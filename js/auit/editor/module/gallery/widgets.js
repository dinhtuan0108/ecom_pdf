Ext.namespace("AuIt.Action.ToolBar.Widget");AuIt.Action.Widget.CREATETEMPLATE={itemId:"WIDGET_CREATETEMPLATE"};AuIt.Action.Widget.EDIT={tooltip:AuIt.locale.Widget_EDIT,scale:"small",iconCls:"elm-partpart-edit-16",itemId:"WIDGET_EDIT",disabled:true,updateState:function(a){if(a.source=="Gallery.Widget"){this.setDisabled(a.selections.length==0)}}};AuIt.Action.Widget.DEL={tooltip:AuIt.locale.Widget_DEL,scale:"small",iconCls:"elm-partpart-del-16",itemId:"WIDGET_DEL",disabled:true,updateState:function(a){if(a.source=="Gallery.Widget"){this.setDisabled(a.selections.length==0)}}};AuIt.Action.Editor.CMD_INSERTWIDGET={baseClass:AuIt.Action.Editor.Base,p:true,disabled:true,itemId:"CMD_INSERTWIDGET",iconCls:"edit-cmd-insertwidget-16",tooltip:AuIt.locale.CMD_INSERTWIDGET,handler:function(){var a=this.baseAction;if(a.actionMgr.fireEvent("beforecmd",a)){AuIt.Editor.Dialog.Widget(this,{onOKInsert:function(c){var b={itemId:"TRANSLATE_BLOCK_TO_HTML",browser:this};AuIt.App.getActionMgr().request(b,{directCall:true,url:AUIT_EDITOR.web_cmd_url,waitMsg:AuIt.locale.CMD_INSERTWIDGET_WAIT,waitWnd:this.el,params:{action:"translate_block_to_html",data:c.template},LoadSuccess:function(e,f){if(e.data){var d=AuIt.App.getActionMgr().getAction("CMD_INSERTCUSTOMCHAR","Editor");d.value=e.data.xhtml;d.executeCmd()}}})}})}}};AuIt.Action.Editor.CMD_INSERTMEDIA={baseClass:AuIt.Action.Editor.Base,p:true,disabled:true,itemId:"CMD_INSERTMEDIA",iconCls:"edit-cmd-insertmedia-16",tooltip:AuIt.locale.CMD_INSERTMEDIA};AuIt.Action.ToolBar.Widget.GALLERY=function(a){return new Ext.Toolbar({items:[a.getAction("EDIT","Widget")]})};AuIt.Editor.Gallery.Widgets=Ext.extend(AuIt.Editor.Gallery.Container,{id:"AuIt.Editor.Gallery.Widgets",title:AuIt.locale.Gallery_WidgetsT,getToolbar:function(){return AuIt.App.getActionMgr().getToolBar("GALLERY","Widget")},putWidgets:function(a){this.store.loadData(this.getDataSource());AuIt.App.getActionMgr().request(a,{directCall:true,url:AUIT_EDITOR.web_cmd_url,waitMsg:false,params:{action:"save_widget_template",data:AUIT_EDITOR.widgets},LoadSuccess:function(b,c){}})},onCmd:function(e){switch(e.itemId){case"WIDGET_CREATETEMPLATE":var a,g=AUIT_EDITOR.widgets,b=[];Ext.applyIf(e.cfg,{menu:"",name:"",image:"",description:"",classname:""});var c=null;if(e.cfg.key&&g[e.cfg.key]){c=e.cfg.key}else{for(a in g){if(g.hasOwnProperty(a)){if(g[a].name==e.cfg.name&&g[a].menu==e.cfg.menu){c=a;break}}}}if(!c){c=(new Date()).getTime()}if(Ext.isArray(AUIT_EDITOR.widgets)){var h={};for(a in AUIT_EDITOR.widgets){if(g.hasOwnProperty(a)){h[a]=AUIT_EDITOR.widgets[a]}}AUIT_EDITOR.widgets=h}AUIT_EDITOR.widgets[c]=e.cfg;this.putWidgets(e);break;case"WIDGET_EDIT":var d=this.getSelectedRecord();if(d){var f=new AuIt.Editor.dlg.widgetEditor({cfg:d});f.show()}break}},onClick:function(a){},getDataSource:function(){return AuIt.Editor.Gallery.Widgets.superclass.getDataSource.call(this,AUIT_EDITOR.widgets)},onSelectionChange:function(a){AuIt.App.getActionMgr().updateState({source:"Gallery.Widget",selections:a})}});