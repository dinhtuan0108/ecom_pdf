Ext.namespace("AuIt.Editor.htmlProperty.Element","AuIt.Action.ToolBar.Element","AuIt.Editor.htmlProperty.Panel","AuIt.Editor.htmlProperty.Grid","AuIt.Editor.htmlProperty.GridEditor");AuIt.Editor.htmlProperty.Attributes={style:{name:AuIt.locale.HTMLPROPERTY_ATTRIBUTES_T1,tooltip:AuIt.locale.HTMLPROPERTY_ATTRIBUTES_T2,editor:"css",DTD:"STF",decode:function(b){b=(b!==undefined)?b:"";if(name=="style"&&b.cssText!==undefined){return""+b.cssText}return b}}};AuIt.Action.ToolBar.Element.DEFAULT=function(b){return["->",b.getAction("DEL","Element"),b.getAction("RESET","Css")]};AuIt.Action.ToolBar.Element.IMG=function(b){return[b.getAction("IMG_RESET","Element"),"->",b.getAction("DEL","Element"),b.getAction("RESET","Css")]};AuIt.Editor.htmlProperty.Container=Ext.extend(Ext.Panel,{title:AuIt.locale.HTMLPROPERTY_CONTAINER_T1,titleP:AuIt.locale.HTMLPROPERTY_CONTAINER_T2,altKey:"E",iconCls:"tab-properties-16",layout:"fit",border:false,frame:false,firstClick:true,tagPanels:null,initComponent:function(){this.tbar=AuIt.Action.ToolBar.Element.DEFAULT(AuIt.App.getActionMgr());this.lastTagToolbar="DEFAULT";AuIt.App.addFktKey({alt:true,key:this.altKey,el:this});this.tagPanels={};AuIt.App.getActionMgr().on("itemchanged",this.onItemChanged,this);AuIt.Editor.htmlProperty.Container.superclass.initComponent.call(this)},destroy:function(){AuIt.App.getActionMgr().un("itemchanged",this.onItemChanged,this);AuIt.Editor.htmlProperty.Container.superclass.destroy.call(this)},onItemChanged:function(b){if(!b.opt){return}this.updateProperty(b)},allowedChange:function(b){this.canNotChange=!b},setTagToolbar:function(b){var c=b.opt.tagName;if(c==this.lastTagToolbar){return}if(AuIt.Action.ToolBar.Element[c]){this.getTopToolbar().removeAll(true);this.getTopToolbar().add(AuIt.Action.ToolBar.Element[c](AuIt.App.getActionMgr()));this.lastTagToolbar=c}else{if(this.lastTagToolbar!="DEFAULT"){this.getTopToolbar().removeAll(true);this.getTopToolbar().add(AuIt.Action.ToolBar.Element.DEFAULT(AuIt.App.getActionMgr()));this.lastTagToolbar="DEFAULT"}}},updateProperty:function(c){var e=AuIt.App.getActiveEditor();if(this.canNotChange){return}if(!c.opt||!c.opt.isEditable){this.setTitle(this.titleP+AuIt.locale.HTMLPROPERTY_CONTAINER_T3);this.removeAll(false).each(function(f){f.hide()});return}var d=c.opt.tagName;if(!AuIt.Editor.htmlProperty.Element[d]){d="DEFAULT";if(!this.tagPanels[d]){this.tagPanels[d]=new AuIt.Editor.htmlProperty.BasicPanel({propertyContainer:this})}}var b=this.tagPanels.DEFAULT;if(this.lastTag!=d){this.lastTag=d;if(!this.tagPanels[d]){if(AuIt.Editor.htmlProperty.Element[d]){b=this.tagPanels[d]=new AuIt.Editor.htmlProperty.Element[d]({propertyContainer:this})}}this.removeAll(false).each(function(f){f.hide()})}if(this.items.getCount()==0){this.add(b)}b.setHTMLElement(c.opt,e);b.show();this.setTagToolbar(c);this.doLayout();if(this.firstClick){this.firstClick=false}this.setTitle(this.titleP+c.opt.tagName)}});AuIt.Editor.htmlProperty.BasicPanel=Ext.extend(Ext.Panel,{cls:"inner-accordion",border:false,frame:false,layout:"accordion",_getPanels:function(){return[new AuIt.Editor.htmlProperty.Panel.Attributes({propertyHandler:this}),new AuIt.Editor.htmlProperty.Panel.Css({propertyHandler:this}),new AuIt.Editor.htmlProperty.Panel.Events({propertyHandler:this})]},initComponent:function(){this.items=this._getPanels();AuIt.Editor.htmlProperty.BasicPanel.superclass.initComponent.call(this)},setHTMLElement:function(c,b){this.editor=b;this.items.each(function(d){d.setHTMLElement(c)})},setModified:function(b){this.editor.setModified(b)}});AuIt.Editor.htmlProperty.Panel.Attributes=Ext.extend(AuIt.Editor.EditorGrid,{title:AuIt.locale.HTMLPROPERTY_PANEL_A_T1,altKey:"A",iconCls:"elm-attribute-16",OnChangeEditEl:function(d,e,b){if(b!="edit"){return}var c=AuIt.App.getActionMgr().getAction("INTERN_SETHTMLATTRIBUTE","Editor");c.data={domID:this.editEl.domID,a:e.data.attribute,value:e.data.value};c.quest(this.propertyHandler.editor.proxy,function(f){this.propertyHandler.setModified("local_only")},this)},setStore:function(){if(!this.editEl){return}var b=this.editEl.dom;this.store.rejectChanges();this.store.clearFilter(true);this.store.each(function(e){a=e.data.attribute;var c=b;switch(a){case"href":if(b.auit_href){e.data.value=b.auit_href}else{e.data.value=b[a]}break;default:if(a!==""){if(b[a]===undefined){a=a}e.data.value=(b[a]!==undefined)?b[a]:"??"+a}break}});this.setStoreFilter()},setHTMLElement:function(e){if(!e){return}var c=e.tagName;if(!AuIt.Editor.htmlProperty.Tags[c]){c="DEFAULT"}if(this.lastTag!=c){this.lastTag=c;var g=AuIt.Editor.htmlProperty.Tags[c];var f=[];for(var b=0;b<g.length;b++){f=f.concat(AuIt.Editor.htmlProperty.AttributeGroups[g[b]])}this.stopEditing();this.store.loadData(f)}AuIt.Editor.htmlProperty.Panel.Attributes.superclass.setHTMLElement.call(this,e)},startTriggerClick:function(b){(function(){this.startEditing(b,1);if(this.activeEditor&&this.activeEditor.field&&this.activeEditor.field.onTriggerClick){this.activeEditor.field.onTriggerClick()}}).defer(10,this)},triggerAtribute:function(b){var c=-1;this.store.each(function(d){c++;if(d.data.attribute==b){return false}},this);if(c>=0){if(!this.rendered){this.on("afterrender",function(d){d.startTriggerClick(c)})}else{this.startTriggerClick(c)}}}});AuIt.Editor.htmlProperty.Panel.Events=Ext.extend(AuIt.Editor.EditorGrid,{title:AuIt.locale.HTMLPROPERTY_PANEL_EVENTS_T1,altKey:"V",iconCls:"elm-event-16",OnChangeEditEl:function(d,e,b){var c=AuIt.App.getActionMgr().getAction("INTERN_SETHTMLEVENTS","Editor");c.data={domID:this.editEl.domID,a:e.data.attribute,value:e.data.value};c.quest(this.propertyHandler.editor.proxy,function(f){this.propertyHandler.setModified("local_only")},this)},setStore:function(){if(!this.editEl){return}var b=this.editEl.dom;this.store.rejectChanges();this.store.clearFilter(true);this.store.each(function(c){a=c.data.attribute;if(a!==""){c.data.value=(b[a]!==undefined)?b[a]:""}});this.setStoreFilter()},setHTMLElement:function(e){if(!e){return}var c=e.tagName;if(!AuIt.Editor.htmlProperty.Events[c]){c="DEFAULT"}if(this.lastTag!=c){this.lastTag=c;var g=AuIt.Editor.htmlProperty.Events[c];var f=[];for(var b=0;b<g.length;b++){f=f.concat(AuIt.Editor.htmlProperty.EventsGroups[g[b]])}this.stopEditing();this.store.loadData(f)}AuIt.Editor.htmlProperty.Panel.Events.superclass.setHTMLElement.call(this,e)}});AuIt.Editor.htmlXPathStatus=Ext.extend(Ext.Component,{lastNode:null,init:function(b){this.bar=b;AuIt.App.getActionMgr().on("itemchanged",this.onItemChanged,this);AuIt.App.getActionMgr().on("cmd",this.onCmd,this)},onCmd:function(b){if(b.itemId=="MAIN_TAB_CHANGE"){this.removePathButtons()}},removePathButtons:function(){this.bar.items.each(function(c){if(c!=this.bar.statusEl&&this.bar.items.length>2){this.bar.remove(c)}},this);this.lastNode=null},onItemChanged:function(d){var b=d.htmlXPathStatus;if(!b){return}if(!b.length){this.removePathButtons();return}this.removePathButtons();var f=function(g,i){var h=AuIt.App.getActionMgr().getAction("INTERN_SELECTNODE","Editor");h.data={value:g.remoteId};h.executeCmd()};for(var c=0;c<b.length;c++){var e=b[c];e.toggleHandler=f;this.bar.insert(0,e)}this.bar.doLayout()}});