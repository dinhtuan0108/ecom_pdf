Ext.namespace("AuIt.Editor");AuIt.Editor.Property.ScopeColumn=function(a){Ext.apply(this,a);if(!this.id){this.id=Ext.id()}this.renderer=this.renderer.createDelegate(this)};AuIt.Editor.Property.ScopeColumn.prototype={init:function(a){this.grid=a;this.grid.on("render",function(){var b=this.grid.getView();b.mainBody.on("mousedown",this.onMouseDown,this)},this)},onMouseDown:function(i,g){if(g.className&&g.className.indexOf("x-grid3-cc-"+this.id)!=-1){i.stopEvent();var b=this.grid.getView().findRowIndex(g);var a=this.grid.store.getAt(b);var d=this.grid.propertyHandler.pagedata.data.use_store;var h=this.grid.fieldsOverall[a.data.attribute].name;var j=d[h];j=(j===true)?false:true;this.grid.propertyHandler.setStoreFlag(h,j);this.grid.getView().refresh()}},renderer:function(i,a,b,h,k,j){var d=this.grid.fieldsOverall[b.data.attribute];if(!d.isScopeStore){return""}var e=this.grid.propertyHandler.pagedata.data.use_store;var g=e[d.name];g=g===true?true:false;a.css+=" x-grid3-check-col-td";return'<div class="x-grid3-check-col'+(g?"-on":"")+' x-grid3-cc-scope">&#160;</div>'}};AuIt.Editor.Property.Grid=Ext.extend(AuIt.Editor.EditorGrid,{useFilter:false,cls:"inner-accordion",scopeText:AuIt.locale.PROPERTY_GRID_T1,groupTextTpl:"{[values.text.substr(3)]}",getCellEditor:function(b,d){var c=AuIt.Editor.Property.Grid.superclass.getCellEditor.call(this,b,d);if(c){return c}var a=this.store.getAt(d);return this.addEditorInfo(this.colModel.createEditor(this.fieldsOverall[a.data.attribute]),b,d)},getColModel:function(){if(this.propertyHandler.pagedata.desc.useScopeColumn){this.valueIndex=2;var a=new AuIt.Editor.Property.ScopeColumn({id:"scope",header:this.scopeText,tooltip:this.scopeText,width:20});a.init(this);return[{id:"name",header:AuIt.locale.PROPERTY_GRID_C1,width:100,sortable:true,dataIndex:"name",renderer:this.renderName,scope:this},a,{id:"value",header:AuIt.locale.PROPERTY_GRID_C2,width:20,sortable:true,editable:true,renderer:this.renderValue,dataIndex:"value",resizable:false,scope:this},{header:"",sortable:false,dataIndex:"CSS_GROUP",hidden:true}]}return AuIt.Editor.Property.Grid.superclass.getColModel.call(this)},OnChangeEditEl:function(g,h,d){if(d!="edit"){return}var b=h.data.attribute;var e=this.fieldsOverall[h.data.attribute];var c=h.data.value;if(e.xtype=="auit_datefield"){}if(this.propertyHandler.pagedata.data.data[e.name]!=c||(this.propertyHandler.pagedata.data.modifiedData&&this.propertyHandler.pagedata.data.modifiedData[e.name]!=c)){this.propertyHandler.pagedata.data.modifiedData[e.name]=c;this.propertyHandler.setModified()}},getDataSource:function(){var h,e,k,d,c,b=this.propertyHandler.pagedata.desc.forms;var a=this.propertyHandler.pagedata.data.data;var l,g=[];this.fieldsOverall=[];for(var h=0;h<b.length;h++){c=b[h];l=String.fromCharCode(65+h)+c.title;for(e=0;e<c.fields.length;e++){k=c.fields[e];if(k){g.push([l,k.fieldLabel,a[k.name],k.xtype,"@"+k.name,k.name,""]);this.fieldsOverall[k.name]=k}}}return g},renderValue:function(m,a,e,j,l,k){if(e.data.einheit.indexOf("dec")>=0){return this.getCellEditor(l,j).field.decode(m)}var f,g,b=m;switch(e.data.einheit){case"combo":g=this.getCellEditor(l,j);b="";if(g){f=g.field.getStore();f.each(function(i){if(i.get("value")==m){b=i.get("text");return false}});return b}break;case"GroupingComboBox":g=this.getCellEditor(l,j);b="";if(g){f=g.field.getStore();var d,c=[],h=m.split(",");for(d=0;d<h.length;d++){c[h[d]]=1}f.each(function(i){if(c[i.get("value")]==1){if(b){b+=","}b+=i.get("text")}});return b}break;case"auit_datefield":return AuIt.Editor.utils.decodeDate(m);break}return AuIt.Editor.Property.Grid.superclass.renderValue.call(this,m,a,e,j,l,k)}});AuIt.Editor.Property.Container=Ext.extend(Ext.Panel,{modified:false,border:false,frame:false,layout:"fit",initComponent:function(){this.pagedata=this.pagedata||{};this.pagedata.data=this.pagedata.data||{};this.pagedata.data.data=this.pagedata.data.data||{};this.pagedata.data.modifiedData=this.pagedata.data.modifiedData||{};this.pagedata.data.use_store=this.pagedata.data.use_store||{};this.items=new AuIt.Editor.Property.Grid({propertyHandler:this});AuIt.Editor.Property.Container.superclass.initComponent.call(this)},getActionMgr:function(){return AuIt.App.getActionMgr()},setStoreFlag:function(b,a){this.pagedata.data.use_store[b]=a;if(this.pagedata.data.modifiedData[b]===undefined){this.pagedata.data.modifiedData[b]=this.pagedata.data.data[b]}this.setModified()},setModified:function(){if(!this.modified){this.modified=true}if(this.editor){this.editor.setModified()}},isDirty:function(){return this.modified},watchTask:function(){},getPanelData:function(){var b=this.pagedata;var d=b.desc.title;var a,c=b.data.data;if((a=c.title)){d+=" - "+a}if((a=c.name)){d+=" - "+a}if((a=c.page_id)){d+=" [ID:"+a+"]"}return{panel:this,title:d,iconcls:b.desc.iconcls}},canSave:function(a){if(this.isDirty()){if(!this.validPropertys()){a.canSave=false;return false}}return true},validPropertys:function(){return true},addSaveData:function(a){if(this.isDirty()){a.addSaveData({page_id:this.pagedata.page_id,typ:"Properties",factory:this.pagedata.factory,storeId:this.pagedata.storeId,data:this._buildSaveData()})}return true},_buildSaveData:function(){return this.pagedata.data},commitChanges:function(a){this.modified=false;this.pagedata.data.modifiedData={};if(this.grid){this.grid.store.commitChanges()}}});AuIt.Editor.Property.CMSPage=Ext.extend(AuIt.Editor.Property.Container,{initComponent:function(){AuIt.Editor.Property.CMSBlock.superclass.initComponent.call(this)}});Ext.namespace("AuIt.Action.ToolBar.CMSBlock");AuIt.Action.ToolBar.CMSBlock.PROPERTY=function(a){return[a.getAction("STATIC_BLOCKS_DUP","cms")]};AuIt.Editor.Property.CMSBlock=Ext.extend(AuIt.Editor.Property.Container,{initComponent:function(){this.tbar=AuIt.Action.ToolBar.CMSBlock.PROPERTY(AuIt.App.getActionMgr());AuIt.Editor.Property.CMSBlock.superclass.initComponent.call(this)}});Ext.namespace("AuIt.Action.InlineBlock","AuIt.Action.ToolBar.InlineBlock");AuIt.Action.ToolBar.InlineBlock.PROPERTY=function(a){return["->",a.getAction("DEL","InlineBlock")]};AuIt.Editor.Property.InlineBlock=Ext.extend(AuIt.Editor.Property.Container,{initComponent:function(){this.tbar=AuIt.Action.ToolBar.InlineBlock.PROPERTY(AuIt.App.getActionMgr());AuIt.Editor.Property.InlineBlock.superclass.initComponent.call(this)},onShow:function(){AuIt.App.getActionMgr().getAction("DEL","InlineBlock").setDisabled(false);AuIt.Editor.Property.InlineBlock.superclass.onShow.call(this)},onHide:function(){AuIt.App.getActionMgr().getAction("DEL","InlineBlock").setDisabled(true);AuIt.Editor.Property.InlineBlock.superclass.onHide.call(this)},initComponent:function(){this.tbar=AuIt.Action.ToolBar.InlineBlock.PROPERTY(AuIt.App.getActionMgr());AuIt.Editor.Property.InlineBlock.superclass.initComponent.call(this)},addSaveData:function(a){return true},onvalidateEdit:function(a){AuIt.Editor.Property.InlineBlock.superclass.onvalidateEdit.call(this,a);this.inlineBlock.setModified()}});AuIt.Editor.Property.CategoryPage=Ext.extend(AuIt.Editor.Property.Container,{});AuIt.Editor.Property.ProductPage=Ext.extend(AuIt.Editor.Property.Container,{});AuIt.Editor.Property.Blog=Ext.extend(AuIt.Editor.Property.Container,{});