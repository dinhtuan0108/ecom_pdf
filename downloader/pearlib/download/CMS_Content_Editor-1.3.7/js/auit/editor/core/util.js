Ext.override(Ext.tree.TreeNode,{afterAdd:function(b,a){if(this.childrenRendered){b.render()}else{if(a){b.renderIndent(true,true)}}}});Ext.override(Ext.ToolTip,{onMouseMove:function(c){var a=this.delegate?c.getTarget(this.delegate):this.triggerElement=true;if(a){this.targetXY=c.getXY();if(a===this.triggerElement){if(!this.hidden&&this.trackMouse){var b=this.getTargetXY();if(this.constrainPosition){b=this.el.adjustForConstraints(b)}this.setPagePosition(b)}}else{this.hide();this.lastActive=new Date(0);this.onTargetOver(c)}}else{if(!this.closable&&this.isVisible()){this.hide()}}}});Ext.namespace("AuIt.Editor");if(!Array.each){Ext.applyIf(Array.prototype,{each:function(d,c){for(var b=0,a=this.length;b<a;b++){if(d.call(c||this[b],this[b],b,this)===false){return b}}return 0}})}Ext.namespace("Ext.ux");Ext.ux.clone=function(d){if(!d||"object"!==typeof d){return d}var e="[object Array]"===Object.prototype.toString.call(d)?[]:{};var b,a;for(b in d){if(d.hasOwnProperty(b)){a=d[b];if(a&&"object"===typeof a){e[b]=Ext.ux.clone(a)}else{e[b]=a}}}return e};AuIt.DomHelper=function(a){a=a||{};Ext.apply(this,a);AuIt.DomHelper.superclass.constructor.call(this)};Ext.extend(AuIt.DomHelper,Ext.util.Observable,{emptyAttributes:" checked disabled ismap readonly nowrap compact declare selected defer multiple noresize noshade ",RE_tagName:/(<\/|<)\s*([^ \t\n>]+)/ig,is_real_gecko:true,_closingTags:" a abbr acronym address applet b bdo big blockquote button caption center cite code del dfn dir div dl em fieldset font form frameset h1 h2 h3 h4 h5 h6 i iframe ins kbd label legend map menu noframes noscript object ol optgroup pre q s samp script select small span strike strong style sub sup table textarea title tt u ul var ",_blockTags:" body form textarea fieldset ul ol dl li div p h1 h2 h3 h4 h5 h6 quote pre table thead tbody tfoot tr td th iframe address blockquote title meta link style head ",stripScripts:false,htmlRemoveTags:null,only7BitPrintablesInURLs:true,stripBaseURL:function(a){var b=a.replace(/\&amp\;/g,"[%AMPAMPER%]");b=b.replace(/\&/g,"&amp;");return b.replace(/\[\%AMPAMPER\%\]/g,"&amp;")},htmlEncode:function(a){if(!a){return""}if(typeof a.replace=="undefined"){a=a.toString()}a=a.replace(/\&amp\;/ig,"[%AMPAMPER%]");a=a.replace(/&/ig,"&amp;");a=a.replace(/</ig,"&lt;");a=a.replace(/>/ig,"&gt;");a=a.replace(/\xA0/g,"&#160;");a=a.replace(/\x22/g,"&quot;");a=a.replace(/\[\%AMPAMPER\%\]/g,"&amp;");return a},isBlockElement:function(a){return a&&a.nodeType==1&&(this._blockTags.indexOf(" "+a.tagName.toLowerCase()+" ")!=-1)},needsClosingTag:function(a){return a&&a.nodeType==1&&(this._closingTags.indexOf(" "+a.tagName.toLowerCase()+" ")!=-1)},_colorToRgb:function(a){return AuIt.Editor.utils.colorToRgb(a)},getHTMLCode:function(m,c,d){var h="";if(!d){d=""}switch(m.nodeType){case 10:case 6:case 12:break;case 2:break;case 4:h+=(Ext.isIE?("\n"+d):"")+"<![CDATA["+m.data+"]]>";break;case 5:h+="&"+m.nodeValue+";";break;case 7:h+=(Ext.isIE?("\n"+d):"")+"<?"+m.target+" "+m.data+" ?>";break;case 1:case 11:case 9:var j;var g;var p=(m.nodeType==1)?m.tagName.toLowerCase():"";if((p=="script"||p=="noscript")&&this.stripScripts){break}if(c){c=!(this.htmlRemoveTags&&this.htmlRemoveTags.test(p))}if(Ext.isIE&&p=="head"){if(c){h+=(Ext.isIE?("\n"+d):"")+"<head>"}var r=RegExp.multiline;RegExp.multiline=true;var f=m.innerHTML.replace(this.RE_tagName,function(s,i,a){return i+a.toLowerCase()}).replace(/\s*=\s*(([^'"][^>\s]*)([>\s])|"([^"]+)"|'([^']+)')/g,'="$2$4$5"$3').replace(/<(link|meta)((\s*\S*="[^"]*")*)>([\n\r]*)/g,"<$1$2 />\n");RegExp.multiline=r;h+=f+"\n";if(c){h+=(Ext.isIE?("\n"+d):"")+"</head>"}break}else{if(c){j=(!(m.hasChildNodes()||this.needsClosingTag(m)));h+=((this.isBlockElement(m))?("\n"+d):"")+"<"+m.tagName.toLowerCase();var q=m.attributes;for(g=0;g<q.length;++g){var n=q.item(g);if(this.is_real_gecko&&(m.tagName.toLowerCase()=="img")&&((n.nodeName.toLowerCase()=="height")||(n.nodeName.toLowerCase()=="width"))){if(!m.complete||m.naturalWidth===0){continue}}if(typeof n.nodeValue=="object"){continue}if(m.tagName.toLowerCase()=="input"&&m.type.toLowerCase()=="checkbox"&&n.nodeName.toLowerCase()=="value"&&n.nodeValue.toLowerCase()=="on"){continue}if(!n.specified&&!(m.tagName.toLowerCase().match(/input|option/)&&n.nodeName=="value")&&!(m.tagName.toLowerCase().match(/area/)&&n.nodeName.match(/shape|coords/i))){continue}var b=n.nodeName.toLowerCase();if(/_moz_editor_bogus_node/.test(b)||(b=="class"&&n.nodeValue=="webkit-block-placeholder")){h="";break}if(/(_moz)|(contenteditable)|(_msh)/.test(b)){continue}var o;if(this.emptyAttributes.indexOf(" "+b+" ")!=-1){o=b}else{if(b!="style"){if(typeof m[n.nodeName]!="undefined"&&b!="href"&&b!="src"&&!(/^on/.test(b))){o=m[n.nodeName]}else{o=n.nodeValue;if(b=="class"){o=o.replace(/Apple-style-span/,"");if(!o){continue}}if(this.only7BitPrintablesInURLs&&(b=="href"||b=="src")){o=o.replace(/([^!-~]+)/g,function(a){return escape(a)})}}}else{if(!Ext.isIE){var l=this;o=m.style.cssText.replace(/rgb\(.*?\)/ig,function(a){return l._colorToRgb(a)})}else{if(!o){continue}}}}if(/^(_moz)?$/.test(o)){continue}h+=" "+b+'="'+this.htmlEncode(o)+'"'}if(Ext.isIE&&m.style.cssText){h+=' style="'+m.style.cssText.replace(/(^)?([^:]*):(.*?)(;|$)/g,function(u,t,s,i,a){return s.toLowerCase()+":"+i+a})+'"'}if(Ext.isIE&&m.tagName.toLowerCase()=="option"&&m.selected){h+=' selected="selected"'}if(h!==""){if(j&&p=="p"){h+=">&nbsp;</p>"}else{if(j){h+=" />"}else{h+=">"}}}}}var e=false;if(0&&(p=="script"||p=="noscript")){if(!this.stripScripts){if(Ext.isIE){var k="\n"+m.innerHTML.replace(/^[\n\r]*/,"").replace(/\s+$/,"")+"\n"+d}else{var k=(m.hasChildNodes())?m.firstChild.nodeValue:""}if(k.indexOf("<![CDATA[")==-1){k="\n//<![CDATA[\n"+k+"\n//]]>\n"}h+=k+"</"+p+">"+((Ext.isIE)?"\n":"")}}else{if(0&&p=="pre"){h+=((Ext.isIE)?"\n":"")+m.innerHTML.replace(/<br>/g,"\n")+"</"+p+">"}else{for(g=m.firstChild;g;g=g.nextSibling){if(!e&&g.nodeType==1&&this.isBlockElement(g)){e=true}h+=this.getHTMLCode(g,true,d+"  ")}if(c&&!j){h+=(((this.isBlockElement(m)&&e)||p=="head"||p=="html")?("\n"+d):"")+"</"+m.tagName.toLowerCase()+">"}}}break;case 3:if(/^script|noscript|style$/i.test(m.parentNode.tagName)){h=m.data}else{if(m.data.trim()==""){if(m.data){h=" "}else{h=""}}else{h=this.htmlEncode(m.data)}}break;case 8:h="<!--"+m.data.replace("<!--","").replace("-->","")+"-->";break}return h}});AuIt.Editor.utils=function(){return{dateShowFormat:"m/d/Y",dateLocalFormat:"Y-m-d",m:"cale",fontSize:function(b,f){var c=b||"12px";var e=parseFloat(c,10);var a="";["em","px","%","pt"].each(function(d){if(c.indexOf(d)>0){a=d}});switch(a){case"em":return e+(0.1*f)+"em";break;case"px":return e+(1*f)+"px";break;case"pt":return e+(1*f)+"pt";break;case"%":return e+(10*f)+"%";break}return""},FontInc:function(a){return AuIt.Editor.utils.fontSize(a,1)},FontDec:function(a){return AuIt.Editor.utils.fontSize(a,-1)},rgbToColor:function(b){var a="#",c;if(!b||/transparent|inherit/.test(b)){return""}if(/^r/.test(b)){Ext.each(b.slice(4,b.length-1).split(","),function(d){c=parseInt(d,10);a+=(c<16?"0":"")+c.toString(16)})}else{b=b.replace("#","");a+=b.length==3?b.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):b}return(a.length>5?a.toLowerCase():"")},colorToRgb:function(c){if(!c){return""}var h,f,a;function e(b){return(b<16)?("0"+b.toString(16)):b.toString(16)}if(typeof c=="number"){h=c&255;f=(c>>8)&255;a=(c>>16)&255;return"#"+e(h)+e(f)+e(a)}if(c.substr(0,3)=="rgb"){var d=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/;if(c.match(d)){h=parseInt(RegExp.$1,10);f=parseInt(RegExp.$2,10);a=parseInt(RegExp.$3,10);return"#"+e(h)+e(f)+e(a)}return null}if(c.substr(0,1)=="#"){return c}return null},nodeToXML:function(a){var c=a.innerHTML;var b=new AuIt.DomHelper();c=b.getHTMLCode(a,true);return c},childsToXML:function(e){var d=new XMLSerializer();var b="",a=0,c=e.childNodes,f;while((f=c[a])){++a;b+=d.serializeToString(f)}b="<AUITROOT>"+b+"</AUITROOT>";b=XML(b).toXMLString();b=b.replace("<AUITROOT>","");b=b.replace("<AUITROOT/>","");return b.replace("</AUITROOT>","")},formatHTMLFragment:function(a){return a},typeNode:function(b,a){a=a||1;while(b&&b.nodeType!=a){b=b.parentNode}return Ext.get(b)},isEditFkt:function(b){return(b&&b.p&&this.n!=1)?false:true},isEditFktT:function(c){var b=AuIt.App;return b.m[c]+((this.n!=1)?" ("+b.m.p+")":"")},decodeDate:function(b,c){c=c||this.dateShowFormat;var a=null;if(Ext.isDate(b)){a=b}if(!a){a=Date.parseDate(b,"Y-m-d H:i:s")}if(!a){a=Date.parseDate(b,this.dateLocalFormat)}if(a){return a.dateFormat(c)}return b}}}();var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=Base64._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var b="";var e=0;var g=0,f=0,d=0;while(e<a.length){g=a.charCodeAt(e);if(g<128){b+=String.fromCharCode(g);e++}else{if((g>191)&&(g<224)){d=a.charCodeAt(e+1);b+=String.fromCharCode(((g&31)<<6)|(d&63));e+=2}else{d=a.charCodeAt(e+1);c3=a.charCodeAt(e+2);b+=String.fromCharCode(((g&15)<<12)|((d&63)<<6)|(c3&63));e+=3}}}return b}};