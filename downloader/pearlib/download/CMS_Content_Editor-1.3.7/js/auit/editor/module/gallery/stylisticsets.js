Ext.namespace("AuIt.Action.ToolBar.Css","AuIt.Action.Css");AuIt.Action.Css.ADD={actionGroup:"EDITOR",tooltip:AuIt.locale.Css_ADD,scale:"small",iconCls:"elm-css-add-16",itemId:"CSS_ADD",updateState:function(b){var a=true;if(b.opt){if(b.opt.isEditable&&(b.opt.cssText||b.opt.className)){a=false}}this.setDisabled(a)}};AuIt.Action.Css.EDIT={tooltip:AuIt.locale.Css_EDIT,scale:"small",iconCls:"elm-css-edit-16",itemId:"CSS_EDIT",disabled:true,updateState:function(a){if(a.source=="Gallery.StylisticSets"){this.setDisabled(a.selections.length==0)}}};AuIt.Action.Css.DEL={tooltip:AuIt.locale.Css_DEL,scale:"small",iconCls:"elm-css-del-16",itemId:"CSS_DEL",disabled:true,updateState:function(a){if(a.source=="Gallery.StylisticSets"){this.setDisabled(a.selections.length==0)}}};AuIt.Action.Css.SETSTYLE={disabled:true,tooltip:AuIt.locale.Css_SETSTYLE,scale:"small",iconCls:"elm-style-set-16",styledisabled:true,editdisabled:true,itemId:"SETSTYLEFROMLIST",updateState:function(b){var a=true;if(b.source=="Gallery.StylisticSets"){this.styledisabled=(b.selections.length==0)}else{if(b.opt){this.editdisabled=!b.opt.isEditable}}this.setDisabled(this.editdisabled||this.styledisabled)}};AuIt.Action.Css.CREATETEMPLATE={itemId:"CSS_CREATETEMPLATE"};AuIt.Action.ToolBar.Css.GALLERY=function(a){return new Ext.Toolbar({items:[a.getAction("ADD","Css"),a.getAction("EDIT","Css"),"-",a.getAction("DEL","Css"),"->",a.getAction("SETSTYLE","Css"),"-",a.getAction("RESET","Css")]})};AuIt.Editor.Gallery.StylisticSets=Ext.extend(AuIt.Editor.Gallery.Container,{id:"AuIt.Editor.Gallery.StylisticSets",altKey:"S",title:AuIt.locale.Gallery_StylisticSetsT,iconCls:"tab-style-16",getToolbar:function(){return AuIt.App.getActionMgr().getToolBar("GALLERY","Css")},putStyles:function(a){this.store.loadData(this.getDataSource());AuIt.App.getActionMgr().request(a,{directCall:true,url:AUIT_EDITOR.web_cmd_url,waitMsg:false,params:{action:"save_css_template",data:AUIT_EDITOR.styles},LoadSuccess:function(b,c){}})},onCmd:function(d){switch(d.itemId){case"CSS_ADD":var f=AuIt.App.getActiveEditor();if(!f){return}var d=AuIt.App.getActionMgr().getAction("INTERN_DOMINFO","Editor");d.data={};d.quest(f.proxy,function(j){var k=new AuIt.Editor.dlg.cssEditor({cfg:{style:j.data.style,classname:j.data.classname}});k.show()},this);break;case"CSS_EDIT":var a=this.getSelectedRecord();if(a){var g=new AuIt.Editor.dlg.cssEditor({cfg:a});g.show()}break;case"CSS_DEL":var a=this.getSelectedRecord();if(a){Ext.MessageBox.show({title:AuIt.locale.Gallery_StylisticSets_DT,msg:AuIt.locale.Gallery_StylisticSets_DM,buttons:Ext.MessageBox.YESNO,fn:function(l){if(l=="yes"){var k=null;var j,n=AUIT_EDITOR.styles;for(j in n){if(n.hasOwnProperty(j)){if(n[j].name==a.name&&n[j].menu==a.menu){k=j;break}}}if(k){n[k]=null;delete n[k]}this.putStyles(d)}},scope:this,icon:Ext.MessageBox.QUESTION})}break;case"SETSTYLEFROMLIST":var a=this.getSelectedRecord();if(a){var d=AuIt.App.getActionMgr().getAction("SET","Css");d.preview=false;d.data=Ext.ux.clone(a);d.executeCmd()}break;case"CSS_CREATETEMPLATE":var c,e=AUIT_EDITOR.styles,h=[];Ext.applyIf(d.cfg,{menu:"",name:"",image:"",description:"",style:"",classname:""});var i=null;if(d.cfg.key&&e[d.cfg.key]){i=d.cfg.key}else{for(c in e){if(e.hasOwnProperty(c)){if(e[c].name==d.cfg.name&&e[c].menu==d.cfg.menu){i=c;break}}}}if(!i){i=(new Date()).getTime()}if(Ext.isArray(AUIT_EDITOR.styles)){var b={};for(c in AUIT_EDITOR.styles){if(e.hasOwnProperty(c)){b[c]=AUIT_EDITOR.styles[c]}}AUIT_EDITOR.styles=b}AUIT_EDITOR.styles[i]=d.cfg;this.putStyles(d);break}},_resetCSSTemp:function(){this.cssOver=true;this.cssOverLeave=false;this.cssOverLast=false;var a=AuIt.App.getActionMgr().getAction("SET","Css");a.data={};a.data.preview=true;a.data.reset=true;a.blocked=true;a.quest(null,function(b){this.cssOver=false;if(this.cssOverLast=="LEAVE"){this._resetCSSTemp()}else{if(this.cssOverLast=="ENTER"){this._setCSSTemp(this.cssOverEnter)}}},this)},_setCSSTemp:function(b){this.cssOver=true;this.cssOverLast=false;var a=AuIt.App.getActionMgr().getAction("SET","Css");a.data=b;a.data.preview=true;this.cssOverEnter=null;a.quest(null,function(c){this.cssOver=false;if(this.cssOverLast=="LEAVE"){this._resetCSSTemp()}else{if(this.cssOverLast=="ENTER"){this._setCSSTemp(this.cssOverEnter)}}},this)},onMouseEnter:function(a){if(this.cssOver){this.cssOverLast="ENTER";this.cssOverEnter=Ext.ux.clone(a);return}this._setCSSTemp(Ext.ux.clone(a))},onMouseLeave:function(a){if(this.cssOver){this.cssOverLast="LEAVE";return}this._resetCSSTemp()},onDblClick:function(a){var b=AuIt.App.getActionMgr().getAction("SET","Css");b.preview=false;b.data=Ext.ux.clone(a);b.quest()},getDataSource:function(){return AuIt.Editor.Gallery.StylisticSets.superclass.getDataSource.call(this,AUIT_EDITOR.styles)},onSelectionChange:function(a){AuIt.App.getActionMgr().updateState({source:"Gallery.StylisticSets",selections:a})}});